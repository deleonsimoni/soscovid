<div id="wrapper">
  <div id="over_map">

    <section class="text-center" style="position: relative;margin-top: 155px;z-index: 1;">

      <!--<select class="form-control" id="opt" [(ngModel)]="categoria" (change)="mudarCategoria()">
                <option *ngFor="let categoriaS of categorias" [value]="categoriaS.id">
                  {{ categoriaS.name }}
                </option>
              </select>-->
      <div class="card" style="width: 18rem;">
        <div class="card-header" style="cursor: pointer;" (click)="exibirCategorias()">
          Em que pode ajudar? <i #categoriaSeta class="fa fa-chevron-down pull-right"></i>
        </div>

        <ul [style.display]="isCategoriaAberta ? 'block' : 'none'" *ngFor="let categoria of categorias"
          class="dontShow list-group list-group-flush">

          <li id="{{categoria.id}}" [ngClass]="{'success':categoriaSelecionada == categoria.id}"
            style="cursor: pointer;" (click)="mudarCategoria(categoria.id)" class="list-group-item text-left">
            <img *ngIf="categoria.icon" style="margin-right: 10px;" [src]="getIconCategoria(categoria.id)" width="30px"
              height="30px" />{{ categoria.name }}
            <span *ngIf="carregando" class="pull-right"><i style='text-align: center;'
                class="fa fa-spinner fa-spin"></i></span>
          </li>

        </ul>
      </div>

      <div class="card" style="width: 18rem;">
        <div class="card-header" style="cursor: pointer; background-color: red; color: white;" (click)="modalSOS()">
          S.O.S Pedir Ajuda <i #categoriaSeta class="fa fa-exclamation-triangle  pull-right"></i>
        </div>
      </div>

    </section>
  </div>
  <agm-map [latitude]="location.lat" [zoom]="location.zoom" [longitude]="location.lng" [styles]="styles">

    <agm-marker *ngFor="let point of points" [iconUrl]="getIconCategoria(categoriaSelecionada)"
      (markerClick)="selectMarker(point)" [latitude]="point.lat" [longitude]="point.lng">
    </agm-marker>

  </agm-map>
</div>

<ng-template #callHelp>
  <div class="modal-upload">
    <div class="modal-header">
      <h4 class="modal-title pull-left">Preciso de Ajuda!</h4>
      <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div class="modal-body" style="background-color: red; color: white; padding: 4px, 4px, 4px, 4px;">
      <div class="mt-2" *ngFor="let necessidade of necessidades; let i = index;">
        O que est√° te faltando?
        <button type="button" class="btn btn-danger" *ngIf="i > 0" (click)="removeHelpForm(i)">Remover</button>

        <input type="text" name="nome_{{i}}" class="form-control mt-2" id="abc613" placeholder="Produto/Alimento"
          [(ngModel)]="necessidade.produto" />
      </div>
      <button type="button" class="btn btn-success mt-2" (click)="addHelpForm()">+</button>

      <textarea [(ngModel)]="help.obs" placeholder="Conte mais do que tem passado..." class="form-control mt-2"
        id="exampleFormControlTextarea1" rows="3"></textarea>

      <div class="justify-content-center">
        <button class="btn btn-primary mt-2" (click)="canHelp()">Pedir Ajuda</button>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #modalTemplate>
  <div class="modal-header">
    <div class="pull-left">
      <h4 class="modal-title">{{ point.nome }}</h4>
      <b>Categoria:</b> {{getNameCategoria(categoriaSelecionada)}}
    </div>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">

    <app-abecedario *ngIf="categoriaSelecionada == 1" [contents]="contents" [isAdmin]="false"
      (remover)="reciverDelete($event)" (alterar)="reciverAlter($event)">
    </app-abecedario>

  </div>
</ng-template>
